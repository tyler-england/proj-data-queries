= Odbc.Query(connStr, 
Text.Combine({"
select mo.JOBNO, mo.ORDNO, mo.FITEM, mo.OPSEQ, mo.OPDSC, mo.SSLHU, SSLHU*SSLAB as SSCST, mo.SRLHU, SRLHU*SRLAB as SRCST, SOVER*(SSLHU*SSLAB+SRLHU*SRLAB)/100 as SOVCST, 
  mo.SLHTD, mo.RLHTD, mo.SLCTD, mo.RLCTD, mo.OVCTD, mo.WKCTR, cc.CATCD, trim(cc.CATDS) as CATDS, mo.MOSrc, co.COSrc from
  (SELECT MOMAST.JOBNO, MOMAST.ORDNO, MOMAST.FITEM, 
    MOROUT.OPSEQ, MOROUT.OPDSC, MOROUT.SSLHU, MOROUT.SRLHU, MOROUT.SSLAB, MOROUT.SRLAB, MOROUT.SOVER, MOROUT.SLHTD, MOROUT.RLHTD, MOROUT.SLCTD, MOROUT.RLCTD, MOROUT.OVCTD, MOROUT.WKCTR, 'ACTIVE' as MOSrc
  FROM AMFLIBW.MOMAST MOMAST
  join AMFLIBW.MOROUT MOROUT on MOMAST.ORDNO = MOROUT.ORDNO
  union
  SELECT MOMAST.JOBNO, MOMAST.ORDNO, MOMAST.FITEM, 
    MOROUT.OPSEQ, MOROUT.OPDSC, MOROUT.SSLHU, MOROUT.SRLHU, MOROUT.SSLAB, MOROUT.SRLAB, MOROUT.SOVER, MOROUT.SLHTD, MOROUT.RLHTD, MOROUT.SLCTD, MOROUT.RLCTD, MOROUT.OVCTD, MOROUT.WKCTR, 'HIST' as MOSrc
  FROM AMFLIBW.MOHMST MOMAST
  join AMFLIBW.MOHRTG MOROUT on MOMAST.ORDNO = MOROUT.ORDNO and MOMAST.CLDT=MOROUT.CLDT) mo
left join 
  (select CDAITX, CDCVNB, 'ACTIVE' as COSrc
  from AMFLIBW.MBCDREP 
  union
  select DRAITX, DRCVNB, 'HIST' as COSrc 
  from AMFLIBW.MBDRREP) co 
on mo.FITEM = co.CDAITX and trim(co.CDCVNB)=trim(mo.JOBNO)
join amflibW.ITMRVA irfi on irfi.ITNBR=mo.FITEM and irfi.STID='AKR' and irfi.ITRV=''
join cmalibW.IMPICD01 cc on cc.ITCLS=irfi.ITCLS
WHERE mo.JOBNO in (",COList,")  and mo.SSLHU + mo.SRLHU + mo.SLHTD + mo.RLHTD>0 and FITEM not like 'PSA-%'
ORDER BY mo.JOBNO, mo.FITEM, mo.OPSEQ"}))